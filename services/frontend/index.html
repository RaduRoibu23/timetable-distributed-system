<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8">
  <title>Timetable Management — Frontend</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">

    <div class="header">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Timetable Management Distributed System</h1>
          <div class="sub">SCD — Frontend demo (Keycloak + API)</div>
        </div>
      </div>
      <div id="status-badge" class="badge">Status: neautentificat</div>
    </div>

    <div class="grid">

      <!-- LEFT: LOGIN / SESSION -->
      <div class="card" id="login-card">
        <div class="card-header">
          <h2>Autentificare</h2>
          <p>Login simplu prin Keycloak Direct Grant (pentru demo/proiect).</p>
        </div>
        <div class="card-body">
          <form id="login-form">
            <div class="field">
              <div class="label">Username</div>
              <input class="input" id="username" name="username" autocomplete="username" placeholder="ex: admin / student1">
            </div>

            <div class="field">
              <div class="label">Password</div>
              <input class="input" id="password" name="password" type="password" autocomplete="current-password" placeholder="parola">
            </div>

            <div class="row row-wrap">
              <button class="btn btn-primary" type="submit" id="btn-login">Login</button>
              <button class="btn" type="button" id="btn-fill-admin">Autofill admin</button>
              <button class="btn" type="button" id="btn-fill-student">Autofill student</button>
            </div>

            <div class="hint" style="margin-top:10px">
              Keycloak: <code class="inline" id="kc-url"></code><br>
              Realm: <code class="inline" id="kc-realm"></code><br>
              Client: <code class="inline" id="kc-client"></code>
            </div>

            <div id="login-error" class="alert hidden"></div>
          </form>
        </div>
      </div>

      <!-- RIGHT: DASHBOARD -->
      <div class="card" id="dashboard-card" style="display:none">
        <div class="card-header">
          <h2>Dashboard</h2>
          <p>Informații sesiune, roluri și operații demo pe API.</p>
        </div>

        <div class="card-body">

          <div class="kv">
            <div class="k">User</div>
            <div class="v" id="user-info">—</div>

            <div class="k">Roles</div>
            <div class="v">
              <div id="roles-pills" class="pills"></div>
            </div>

            <div class="k">Token expires</div>
            <div class="v" id="token-exp">—</div>

            <div class="k">API Base</div>
            <div class="v"><code class="inline" id="api-base"></code></div>
          </div>

          <div class="row row-wrap" style="margin-top:12px">
            <button class="btn" id="btn-refresh">Refresh token</button>
            <button class="btn btn-danger" id="btn-logout">Logout</button>
          </div>

          <div class="tabs" style="margin-top:14px">
            <button class="tab active" data-tab="overview">Overview</button>
            <button class="tab" data-tab="role">Role view</button>
            <button class="tab" data-tab="api">API demo</button>
          </div>

          <div id="tab-overview" class="section">
            <h3>Ce demonstrează acest frontend</h3>
            <p>
              Autentificare prin Keycloak, decodare JWT pentru afișare roluri, refresh token și apeluri către backend cu Bearer token.
              Interfața este gândită pentru prezentare la SCD: clară, separată pe roluri, ușor de extins cu pagini reale.
            </p>
          </div>

          <div id="tab-role" class="section" style="display:none">
            <h3>Vedere pe rol</h3>
            <div id="role-view" class="hint">—</div>
          </div>

          <div id="tab-api" class="section" style="display:none">
            <h3>API demo</h3>
            <p class="hint" style="margin-bottom:10px">
              Exemplu: call către <code class="inline">/me</code> (sau alt endpoint din backend-ul tău).
              Dacă endpoint-ul diferă, îl modifici în <code class="inline">app.js</code>.
            </p>
            <div class="row row-wrap">
              <button class="btn btn-primary" id="btn-call-me">Call /me</button>
              <button class="btn" id="btn-call-rooms">Call /rooms</button>
            </div>
            <div id="api-result" class="hint" style="margin-top:12px; white-space:pre-wrap"></div>
          </div>

          <div class="footer">
            Tip: pentru producție, flow-ul recomandat este Authorization Code + PKCE (în special pentru front-end).
            Pentru demo SCD, Direct Grant este ok dacă îl explici ca “simplificare”.
          </div>

        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/keycloak-js@latest/dist/keycloak.min.js"></script>
  <script src="config.js"></script>
  <script src="app.js"></script>
</body>
</html>
